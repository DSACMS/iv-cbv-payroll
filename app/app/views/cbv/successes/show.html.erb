<% title = t(".header", agency_acronym: agency_translation("shared.agency_acronym")) %>
<% content_for :title, title %>
<div class="grid-col tablet:grid-col-8">
  <div class="margin-bottom-4">
    <h1><%= title %></h1>
    <p><%= t(".confirmation_code_html", confirmation_code: @cbv_flow.confirmation_code) %></p>
    <div class="maxw-card-lg">
      <%= render(LinkWithIconComponent.new(
        t(".download"),
        icon: "file_download",
        class: "usa-button",
        icon_position: :leading,
        variant: :primary,
        url: cbv_flow_submit_path(format: "pdf"),
        target: "_blank",
        rel: "noopener noreferrer"
      )) %>
    </div>
  </div>

  <div class="margin-bottom-5">
    <h2><%= t(".whats_next") %></h2>
    <ul class="usa-icon-list margin-top-3">
      <li class="usa-icon-list__item margin-bottom-3">
        <div class="usa-icon-list__icon display-flex flex-justify-center flex-align-center width-6 minw-6 height-6 bg-primary-lighter radius-top-pill radius-bottom-pill margin-right-1">
          <svg class="usa-icon" aria-hidden="true" role="img">
            <use href="<%= asset_path("@uswds/uswds/dist/img/sprite.svg#attach_money") %>"></use>
          </svg>
        </div>
        <div class="usa-icon-list__content">
          <h3 class="margin-bottom-1"><%= t(".whats_next_1_title") %></h3>
          <p><%= t(".whats_next_1_li_1", agency_acronym: agency_translation("shared.agency_acronym")) %></p>
          <p><%= t(".whats_next_1_li_2_html", agency_portal_name: agency_translation("shared.agency_portal_name"), agency_website: current_agency.agency_contact_website) %></p>
        </div>
      </li>
      <li class="usa-icon-list__item">
        <div class="usa-icon-list__icon display-flex flex-justify-center flex-align-center width-6 minw-6 height-6 bg-primary-lighter radius-top-pill radius-bottom-pill margin-right-1">
          <svg class="usa-icon" aria-hidden="true" role="img">
            <use href="<%= asset_path("@uswds/uswds/dist/img/sprite.svg#groups") %>"></use>
          </svg>
        </div>
        <div class="usa-icon-list__content">
          <h3 class="margin-bottom-1"><%= t(".share_invitation_link_title") %></h3>
          <p><%= t(".share_invitation_link_content") %></p>

          <div data-controller="copy-link" class="display-flex">
            <%= form_with(builder: UswdsFormBuilder, html: { class: "display-contents" }) do |f| %>
              <%= f.label :invitation_link, t(".invitation_link_label"), class: "usa-sr-only" %>
              <input value="<%= @invitation_link %>" autocomplete="off" readonly class="usa-input margin-top-0 maxw-card-lg" data-copy-link-target="input" type="text" name="invitation_link" id="invitation_link">
              <%= f.button_with_icon(t(".copy_link"),
                class: "copy-link-button usa-button--outline maxw-card",
                icon: "content_copy",
                icon_position: :leading,
                variant: :primary,
                type: "button",
                data: {
                  copy_link_target: "copyLinkButton",
                  action: "click->copy-link#copy"
                }) %>

              <%= f.button_with_icon(t(".copied_link"),
                class: "copy-link-button invisible maxw-card",
                icon: "check_circle",
                icon_position: :leading,
                variant: :success,
                type: "button",
                data: {
                  copy_link_target: "successButton"
                }) %>
            <% end %>
          </div>
        </div>
      </li>
    </ul>
  </div>

  <div class="divider margin-top-5"></div>

  <div>
    <h2 class="margin-top-5"><%= t(".whats_next_2_title") %></h2>
      <p class="line-height-sans-4"><%= t(".whats_next_2_li_1_html") %></p>
      <%= render(LinkWithIconComponent.new(
        t(".survey"),
        icon: "launch",
        class: "usa-button usa-button--outline",
        icon_position: :trailing,
        url: feedbacks_path(form: "survey"),
        target: "_blank",
        rel: "noopener noreferrer"
      )) %>
  </div>
</div>
