<% content_for :title, "Demo Launcher" %>
<div class="grid-col tablet:grid-col-8 demo-launcher">
  <h1>Emmy Launcher</h1>
  <div class="usa-hint demo-launcher__usa-hint">Configure settings and launch Emmy in a new tab.</div>

  <%= form_with(url: "/demo", method: :post, builder: UswdsFormBuilder, html: { class: "usa-form usa-form--large" }, data: { turbo: false, controller: "demo-launcher" }) do |f| %>
    <input type="hidden" name="flow_type" value="activity">

    <h2>Behavior</h2>

    <h3>Agency</h3>
    <div class="usa-hint demo-launcher__usa-hint">Specify the agency the flow will use.</div>
    <div class="usa-form-group">
      <select class="usa-select" name="client_agency_id" id="client_agency_id">
        <option value="sandbox" selected>sandbox</option>
      </select>
    </div>

    <h3>Reporting window</h3>
    <div class="usa-hint demo-launcher__usa-hint">Specify the type of flow you want to create. This determines the number of months in the reporting window.</div>
    <div class="usa-form-group">
      <div class="usa-radio">
        <input class="usa-radio__input usa-radio__input--tile" type="radio" name="reporting_window" id="reporting_window_application" value="application" <%= "checked" unless params[:reporting_window] == "renewal" %> data-action="demo-launcher#selectWindow">
        <label class="usa-radio__label" for="reporting_window_application">Application</label>
      </div>
      <div data-demo-launcher-target="monthButtons" class="demo-launcher__month-buttons">
        <button type="button" class="usa-button" data-months="1" data-action="demo-launcher#selectMonths">1 month</button>
        <button type="button" class="usa-button" data-months="2" data-action="demo-launcher#selectMonths">2 months</button>
        <button type="button" class="usa-button" data-months="3" data-action="demo-launcher#selectMonths">3 months</button>
      </div>
      <div class="usa-radio">
        <input class="usa-radio__input usa-radio__input--tile" type="radio" name="reporting_window" id="reporting_window_renewal" value="renewal" <%= "checked" if params[:reporting_window] == "renewal" %> data-action="demo-launcher#selectWindow">
        <label class="usa-radio__label" for="reporting_window_renewal">Renewal</label>
      </div>
    </div>

    <div class="usa-form-group">
      <div class="usa-hint demo-launcher__usa-hint demo-launcher__separator">-- or --</div>
      <div class="usa-hint demo-launcher__usa-hint">Specify the reporting window manually.</div>
      <input class="usa-input usa-input--sm" type="number" name="reporting_window_months"
             id="reporting_window_months" min="1" max="99" autocomplete="off"
             value="<%= params[:reporting_window_months] %>"
             data-demo-launcher-target="monthsInput">
    </div>

    <h3>Session timeout (minutes)</h3>
    <div class="usa-hint demo-launcher__usa-hint">The warning modal appears 5 min before expiry, so use 6+ to avoid an immediate warning.</div>
    <div class="usa-form-group">
      <input class="usa-input usa-input--sm" type="number" name="demo_timeout"
             id="demo_timeout" min="1" max="999" autocomplete="off"
             value="<%= params[:demo_timeout] || 30 %>">
    </div>

    <button type="submit" name="launch_type" value="tokenized" formtarget="_blank" class="usa-button">Launch tokenized flow</button>
    <button type="submit" name="launch_type" value="generic" formtarget="_blank" class="usa-button usa-button--outline">Launch generic flow</button>
  <% end %>
</div>
