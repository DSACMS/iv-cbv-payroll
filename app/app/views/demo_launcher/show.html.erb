<% content_for :title, "Demo Launcher" %>
<div class="grid-col tablet:grid-col-8 demo-launcher">
  <h1>Emmy Launcher ğŸ†ğŸš€</h1>
  <div class="usa-hint demo-launcher__usa-hint">Configure settings and launch Emmy in a new tab.</div>

  <%= render Uswds::Alert.new(type: :info, heading: "These are overrides, not environment settings", class: "margin-top-2") do %>
    The settings below only apply to links generated by this form. They do not change the actual environment configuration.
  <% end %>

  <%= form_with(url: "/demo", method: :post, builder: UswdsFormBuilder, html: { class: "usa-form usa-form--large" }, data: { turbo: false, controller: "demo-launcher" }) do |f| %>
    <input type="hidden" name="flow_type" value="activity">

    <h2>Behavior</h2>

    <%= render DemoLauncher::SettingComponent.new(title: "Agency", hint: "Specify the agency the flow will use.") do %>
      <select class="usa-select" name="client_agency_id" id="client_agency_id">
        <option value="sandbox" selected>sandbox</option>
      </select>
    <% end %>

    <%= render DemoLauncher::SettingComponent.new(title: "Reporting window", hint: "Specify the type of flow you want to create. This determines the number of months in the reporting window.") do %>
      <div class="usa-radio">
        <input class="usa-radio__input usa-radio__input--tile" type="radio" name="reporting_window" id="reporting_window_application" value="application" <%= "checked" unless params[:reporting_window] == "renewal" %> data-action="demo-launcher#selectWindow">
        <label class="usa-radio__label" for="reporting_window_application">Application</label>
      </div>
      <div data-demo-launcher-target="monthButtons" class="demo-launcher__month-buttons">
        <button type="button" class="usa-button" data-months="1" data-action="demo-launcher#selectMonths">1 month</button>
        <button type="button" class="usa-button" data-months="2" data-action="demo-launcher#selectMonths">2 months</button>
        <button type="button" class="usa-button" data-months="3" data-action="demo-launcher#selectMonths">3 months</button>
      </div>
      <div class="usa-radio">
        <input class="usa-radio__input usa-radio__input--tile" type="radio" name="reporting_window" id="reporting_window_renewal" value="renewal" <%= "checked" if params[:reporting_window] == "renewal" %> data-action="demo-launcher#selectWindow">
        <label class="usa-radio__label" for="reporting_window_renewal">Renewal</label>
      </div>
      <div class="usa-hint demo-launcher__separator">-- or --</div>
      <div class="usa-hint">Specify the reporting window manually.</div>
      <div class="demo-launcher__inline-field">
        <input class="usa-input usa-input--sm" type="number" name="reporting_window_months"
               id="reporting_window_months" min="1" max="99" autocomplete="off"
               value="<%= params[:reporting_window_months] %>"
               data-demo-launcher-target="monthsInput">
        <span>months</span>
      </div>
    <% end %>

    <%= render DemoLauncher::SettingComponent.new(title: "Session timeout", hint: "Specify the number of minutes it should take for the session to time out. Note: the warning modal appears 5 min before timeout, so use 6 or higher to avoid an immediate warning.") do %>
      <div class="demo-launcher__inline-field">
        <input class="usa-input usa-input--sm" type="number" name="demo_timeout"
               id="demo_timeout" min="1" max="999" autocomplete="off"
               value="<%= params[:demo_timeout] || 30 %>">
        <span>minutes</span>
      </div>
    <% end %>

    <button type="submit" name="launch_type" value="tokenized" formtarget="_blank" class="usa-button">Launch tokenized flow</button>
    <button type="submit" name="launch_type" value="generic" formtarget="_blank" class="usa-button usa-button--outline">Launch generic flow</button>
  <% end %>
</div>
