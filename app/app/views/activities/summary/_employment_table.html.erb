
  account_id = payroll_account.aggregator_account_id
  summary = aggregator_report.summarize_by_employer[account_id]
  monthly = aggregator_report.summarize_by_month[account_id] || {}
  latest_month = monthly.keys.max
  month_data = monthly[latest_month]
%>

<%= render(TableComponent.new(is_responsive: true)) do |table| %>
  <%= table.with_subheader_row(class_names: "subheader-row base-lightest border-top-1px") do |row| %>
    <% row.with_data_cell(is_header: true).with_content(t("activities.summary.income.header")) %>
    <% row.with_data_cell(is_header: true).with_content(t("activities.summary.your_details")) %>
  <% end %>
  <%= table.with_row do |row| %>
    <%= row.with_data_cell(is_header: true) do %>
      <%= t("activities.summary.income.employer") %>
    <% end %>
    <%= row.with_data_cell do %>
      <%= summary[:employment]&.employer_name || t("shared.not_applicable") %>
    <% end %>
  <% end %>
  <%= table.with_row do |row| %>
    <%= row.with_data_cell(is_header: true) do %>
      <%= t("activities.summary.income.month") %>
    <% end %>
    <%= row.with_data_cell do %>
      <%= latest_month ? Date.strptime(latest_month, "%Y-%m").strftime("%B %Y") : t("shared.not_applicable") %>
    <% end %>
  <% end %>
  <%= table.with_row do |row| %>
    <%= row.with_data_cell(is_header: true) do %>
      <%= t("activities.summary.income.gross_income") %>
    <% end %>
    <%= row.with_data_cell do %>
      <%= month_data ? format_money(month_data[:accrued_gross_earnings]) : t("shared.not_applicable") %>
    <% end %>
  <% end %>
  <%= table.with_row do |row| %>
    <%= row.with_data_cell(is_header: true) do %>
      <%= t("activities.summary.income.hours_worked") %>
    <% end %>
    <%= row.with_data_cell do %>
      <%= month_data ? format_hours(month_data[:total_w2_hours] || month_data[:total_gig_hours]) : t("shared.not_applicable") %>
    <% end %>
  <% end %>
<% end %>
